---
title: "A3: SPL Library Checkouts"
output: html_document
---

### Introduction

The dataset that I chose to use is "Dataset with all items checked out in 2022-2023" from Seattle Public Library. This dataset is refreshed monthly and includes all physical and digital items checked out in 2022-2023. There are a total of 13 variables (columns) and a total of 2,757,014 observations (rows) in the dataset. The information in the dataset includes but is not limited to book types (physical or digital or audio), book title, author, publisher, publication year, check-out year and month, total check-out times, and subjects. The trends and books I choose to analyze will be related to Harry Potter since I'm a big fan of the Harry Potter series and very much into fantasy novels. I'm also always interested in the popularity of the Harry Potter series in recent years since it was published long ago. Moreover, there are also recent negative comments about J.K. Rowling, and the newly released game Hogwarts Legacy (released on 2/10) might contribute to its changing popularity. I want to learn and research more if they relate to any changes in its book series' popularity.

### Summary Information

I have created 5 questions to gather the 5 values. All the questions and preparation works are done in the file "summary.R". From the collected values, I got to know the Harry Potter-related books that are checked out the most by people from all time is "Harry Potter and the Chamber of Secrets: Harry Potter Series, Book 2 (unabridged)", which is checked out 196 times (Value 1). I also learned the month with the most Harry Potter book checkouts in 2022-2023, which is March 2022 (Value 2). I also found the month with the most checkout for all Harry Potter-related ebooks is March 2022 (Value 3). It is the same as the previous value, which pretty surprised me. I have also calculated the average number of checkouts for Harry Potter-related books, which is 10.30457 (Value 5). Lastly, I have calculated how many print book checkouts changed over time (Value 4). This data shows that people check out more or fewer Harry Potter books, which could demonstrate their interest in the topic. With these data, I could answer my questions like what is the impact of the Covid pandemic on the checkout of different types of books related to Harry Potter and how people's interest in Harry Potter changed over time due to outside circumstances.


### The Dataset

- Who collected/published the data?

The data is collected and published by the Seattle Public Library. However, David Christensen, the data analyst who worked at Seattle Public Library before, helped with the data collection process.

- What are the parameters of the data (dates, number of checkouts, kinds of books, etc.)?

The data parameters included book types (physical or digital or audio), check-out type, book ISBN, book title, author, publisher, publication year, check-out year and month, total check-out times, and subjects/categories.

- How was the data collected or generated?
- Why was the data collected?
- What, if any, ethical questions do you need to consider when working with this data?
- What are possible limitations or problems with this data?   (at least 200 words)


### First Trends Over Time Chart

The first chart I included is "Different Types of Harry Potter Books Checkouts Overtime". The x-axis is the months in 2022 and 2023 and the y-axis is the number of checkouts. There total two types of books - "Digital" and "Physical". I want to include this chart because I want to know if any changes caused by the pandemic resulted in more digital book checkouts than physical book checkouts. The chart proves this guess I analyzed as the digital number of checkouts has slowly decreased, and the physical checkouts gradually increased as the time approaches 2023 (people's lives are getting back to normal in 2023, unaffected by the pandemic). However, digital book checkouts are still much higher than physical book checkouts. This phenomenon might represent the advancement of technology in the current era and the ease for people to read books online.

```{r echo=FALSE, warning=FALSE, message=FALSE}
# Load libraries
library("tidyr")
library("dplyr")
library("stringr")
library("ggplot2")
library("readr")
library("scales")
library("RColorBrewer")

# Prepare the sub-dataframe for building the chart
spl_df <- read.csv("~/Desktop/2022-2023-All-Checkouts-SPL-Data.csv", stringsAsFactors = FALSE)

harry_potter <- spl_df %>%
  filter(str_detect(Title, "Harry Potter"))

harry_potter <- harry_potter %>% mutate(date = paste0(CheckoutYear, "-", CheckoutMonth,  "-01" ))
harry_potter$date <- as.Date(harry_potter$date, format = "%Y-%m-%d")

sum_checkout_monthly <- harry_potter %>%
  group_by(date, UsageClass) %>% 
  summarize(all_checkouts = sum(Checkouts))

book_types_checkout <- sum_checkout_monthly %>%
  select("UsageClass", "all_checkouts", "date")

# building the chart
ggplot(book_types_checkout, aes(x = date, y = all_checkouts, color = UsageClass)) +
  geom_point() +
  geom_line() +
  scale_y_continuous(breaks = seq(0, 1200, 100)) +
  labs(title = "Digital vs Physical Harry Potter Books Checkouts Overtime",
       x = "Month of the Year",
       y = "Number of Checkouts",
       color = "Book Types"
  )
```

### Second Trends Over Time Chart

The second chart that I'm including is the "Harry Potter Books Checkout Summary Overtime Organized by Book Material Types". The x-axis is the months in 2022 and 2023 and the y-axis is the number of checkouts. There total two 8 materials for the book: audiobook, physical book, ebook, music, regprint, sound disc, sound rec, and video disc.

``````{r, echo = FALSE, code = readLines("chart_2.R")}
```

### Your Choice

The last chart is up to you. It could be a line plot, scatter plot, histogram, bar plot, stacked bar plot, and more. Here are some requirements to help guide your design:

- You must have clear x and y axis labels
- The chart needs a clear titleÂ 
- You need a legend for your different line colors and a clear legend title

Here's an example of how to run an R script inside an RMarkdown file:

``````{r, echo = FALSE, code = readLines("chart2_example.R")}
```


